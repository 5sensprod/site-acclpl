<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Capture d'image en temps réel</title>
</head>
<body>
	<h1>Capture d'image en temps réel</h1>
	<div>
		<button id="capture">Prendre une photo</button>
	</div>
	<div>
		<img id="photo" src="" alt="Votre photo">
	</div>

	<script>
		const captureButton = document.getElementById('capture');
		const photo = document.getElementById('photo');

		captureButton.addEventListener('click', function requestCamera() {
			// Demander l'accès à la caméra
			navigator.mediaDevices.getUserMedia({ video: true })
				.then((stream) => {
					// Afficher le flux vidéo dans un élément vidéo caché
					const video = document.createElement('video');
					video.srcObject = stream;
					video.autoplay = true;
					video.hidden = true;
					document.body.appendChild(video);

					// Prendre une capture d'image en cliquant sur le bouton de capture
					captureButton.addEventListener('click', () => {
						const canvas = document.createElement('canvas');
						canvas.width = video.videoWidth;
						canvas.height = video.videoHeight;
						canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
						photo.src = canvas.toDataURL('image/png');

						// Arrêter le flux vidéo
						stream.getTracks().forEach((track) => {
							track.stop();
						});

						// Supprimer l'écouteur d'événements pour éviter de prendre plusieurs photos
						captureButton.removeEventListener('click', requestCamera);
					});
				})
				.catch((error) => {
					console.error('Erreur lors de la demande d\'accès à la caméra :', error);
				});
			// Supprimer l'écouteur d'événements pour éviter de demander l'accès à la caméra plusieurs fois
			captureButton.removeEventListener('click', requestCamera);
		});
	</script>
</body>
</html>
